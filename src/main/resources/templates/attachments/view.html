<!--
  Eclipse Public License - v 2.0

    THE ACCOMPANYING PROGRAM IS PROVIDED UNDER THE TERMS OF THIS ECLIPSE
    PUBLIC LICENSE ("AGREEMENT"). ANY USE, REPRODUCTION OR DISTRIBUTION
    OF THE PROGRAM CONSTITUTES RECIPIENT'S ACCEPTANCE OF THIS AGREEMENT.
-->

{#if currentUser != null && (currentUser.type == 'support' || currentUser.type == 'tam')}
{#include support-layout}
{#content}
<style>
    .attachment-meta {
        color: #555;
        margin-bottom: 16px;
    }
    .text-viewer {
        border: 1px solid #ddd;
        background: #fff;
        max-height: 70vh;
        overflow: auto;
        font-family: "Courier New", monospace;
        font-size: 14px;
        text-align: left;
    }
    .text-line {
        display: grid;
        grid-template-columns: 60px 1fr;
        gap: 12px;
        padding: 2px 12px;
    }
    .text-line:nth-child(even) {
        background: #fafafa;
    }
    .line-number {
        text-align: left;
        color: #999;
        user-select: none;
    }
    .line-content {
        white-space: pre;
    }
    .image-wrapper {
        border: 1px solid #ddd;
        background: #fff;
        padding: 12px;
        max-height: 70vh;
        overflow: auto;
    }
    .image-wrapper img {
        max-width: 100%;
        height: auto;
        display: block;
    }
</style>

<h1>{attachment.name}</h1>
<div class="attachment-meta">{attachment.mimeType} - {attachment.sizeLabel}</div>
{#if isImage}
<div class="image-wrapper">
    <img src="{imageData}" alt="{attachment.name}">
</div>
{#else}
<div class="text-viewer">
    {#for line in lines}
    <div class="text-line">
        <span class="line-number">{line.number}</span>
        <span class="line-content">{line.content}</span>
    </div>
    {/for}
</div>
{/if}
{/content}
{/include}
{#else}
{#include layout}
{#content}
<style>
    .attachment-meta {
        color: #555;
        margin-bottom: 16px;
    }
    .text-viewer {
        border: 1px solid #ddd;
        background: #fff;
        max-height: 70vh;
        overflow: auto;
        font-family: "Courier New", monospace;
        font-size: 14px;
        text-align: left;
    }
    .text-line {
        display: grid;
        grid-template-columns: 60px 1fr;
        gap: 12px;
        padding: 2px 12px;
    }
    .text-line:nth-child(even) {
        background: #fafafa;
    }
    .line-number {
        text-align: left;
        color: #999;
        user-select: none;
    }
    .line-content {
        white-space: pre;
    }
    .image-wrapper {
        border: 1px solid #ddd;
        background: #fff;
        padding: 12px;
        max-height: 70vh;
        overflow: auto;
    }
    .image-wrapper img {
        max-width: 100%;
        height: auto;
        display: block;
    }
</style>

<h1>{attachment.name}</h1>
<div class="attachment-meta">{attachment.mimeType} - {attachment.sizeLabel}</div>
{#if isImage}
<div class="image-wrapper">
    <img src="{imageData}" alt="{attachment.name}">
</div>
{#else}
<div class="text-viewer">
    {#for line in lines}
    <div class="text-line">
        <span class="line-number">{line.number}</span>
        <span class="line-content">{line.content}</span>
    </div>
    {/for}
</div>
{/if}
{/content}
{/include}
{/if}
